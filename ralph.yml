# oflike-metal Development Configuration
#
# SwiftUI + Metal ã§ openFrameworks ã‚’å†å®Ÿè£…
# ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆé§†å‹•é–‹ç™º: CHECKLIST.md ã® [ ] ã‚’ [x] ã«å¤‰ãˆã¦ã„ã
#
# Flow:
#   Builder â†’ Confessor â†’ Committer â†’ Handler â†’ (repeat)
#   - Builder: ã‚¿ã‚¹ã‚¯å®Ÿè£… + CHECKLISTæ›´æ–°
#   - Confessor: ARCHITECTUREæº–æ‹ ãƒã‚§ãƒƒã‚¯
#   - Committer: git commit + push (GitHubã§é€²æ—ç¢ºèªå¯èƒ½)
#   - Handler: æ¬¡ã®ã‚¿ã‚¹ã‚¯é¸å®š
#
# Usage:
#   cd /path/to/oflike_metal_skeleton
#   ralph run -c ralph.yml -p "docs/CHECKLIST.md"
#
# Examples:
#   # Phaseåˆ¥ã«ä½œæ¥­:
#   ralph run -c ralph.yml -p "Phase 1: SwiftUI + Metal åŸºç›¤ã‚’å®Ÿè£…"
#
#   # ç‰¹å®šã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œ:
#   ralph run -c ralph.yml -p "ofDrawCircle() ã‚’å®Ÿè£…"
#
#   # æ¬¡ã®ã‚¿ã‚¹ã‚¯ã‚’è‡ªå‹•é¸æŠ:
#   ralph run -c ralph.yml -p "docs/CHECKLIST.md ã®æ¬¡ã®ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè£…"
#
# GitHub Progress:
#   å„ã‚¿ã‚¹ã‚¯å®Œäº†å¾Œã«è‡ªå‹•ã§pushã•ã‚Œã‚‹ã®ã§ã€ãƒªãƒ¢ãƒ¼ãƒˆã§é€²æ—ç¢ºèªå¯èƒ½

event_loop:
  prompt_file: "PROMPT.md"
  completion_promise: "LOOP_COMPLETE"
  max_iterations: 1000
  max_runtime_seconds: 14400  # 4 hours
  checkpoint_interval: 5
  starting_event: "build.task"

cli:
  backend: "claude"

core:
  specs_dir: "./docs/"
  guardrails:
    # === ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆé§†å‹• (æœ€é‡è¦) ===
    - "docs/CHECKLIST.md ã® [ ] ã‚’è¦‹ã¤ã‘ã¦å®Ÿè£… â†’ [x] ã«æ›´æ–°"
    - "Phase 0 â†’ Phase 1 â†’ ... ã®é †ã«é€²ã‚ã‚‹ (Addonsã¯Phase 12ã§æœ€å¾Œ)"
    - "âš ï¸ CHECKLIST.md ã® [x] æ›´æ–°ãªã—ã«æ¬¡ã«é€²ã‚“ã§ã¯ã„ã‘ãªã„"
    - "âš ï¸ build.done ç™ºè¡Œå‰ã« grep ã§ [x] æ›´æ–°ã‚’å¿…ãšæ¤œè¨¼"
    # === ARCHITECTURE.md çµ¶å¯¾ãƒ«ãƒ¼ãƒ« ===
    - "SwiftUIãŒå”¯ä¸€ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ (ofMainã¯æ’¤å»ƒ)"
    - "macOS 13.0æœ€å°; macOS 14+æ©Ÿèƒ½ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ (ä¾‹: VisionKit)"
    - "åº§æ¨™ç³»: 2Då·¦ä¸Š/3Då³æ‰‹/Textureå·¦ä¸Š; Metal NDC(Yåè»¢/Z0..1)ã¯rendererã§å¸å"
    - "âŒ FreeType â†’ Core Text"
    - "âŒ OpenGL â†’ Metal"
    - "âŒ SDL/GLFW â†’ SwiftUI + MTKView"
    - "âŒ stb_image â†’ ImageIO / MTKTextureLoader"
    - "âŒ AppKitç›´æ¥ä½¿ç”¨ â†’ SwiftUI (ä½ãƒ¬ãƒ™ãƒ«ãƒ–ãƒªãƒƒã‚¸ã®ã¿è¨±å¯)"
    - "âŒ GLM/å¤–éƒ¨SIMD â†’ simd/simd.h, Accelerate"
    - "âŒ Poco/Cairo/Assimp â†’ Foundation/Network, Core Graphics, Model I/O"
    # === 5ã¤ã®æŸ± ===
    - "âœ… SwiftUI - ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã€ã‚¤ãƒ™ãƒ³ãƒˆã€UI"
    - "âœ… Metal - GPUãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°"
    - "âœ… C++è¨˜è¿° - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ¼ãƒ‰ã¯C++"
    - "âœ… oF APIäº’æ› - openFrameworksã¨åŒã˜API"
    - "âœ… Apple Native - Core ML/Vision/PHASE/MetalFXç­‰"
    # === å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ ===
    - "pImplãƒ‘ã‚¿ãƒ¼ãƒ³ - ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ˜ãƒƒãƒ€ãƒ¼ã¯ç´”ç²‹C++ (.h)"
    - "Objective-C++ - å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ (.mm)"
    - "@autoreleasepool - ObjCã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç”Ÿæˆæ™‚ã¯å¿…é ˆ"
    # === Git ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ ===
    - "ã‚¿ã‚¹ã‚¯å®Œäº†ã”ã¨ã«ã‚³ãƒŸãƒƒãƒˆ + GitHubã«push"
    - "Conventional Commitså½¢å¼: feat(phase-X): description"
    - "CHECKLIST.md ã®æ›´æ–°ã‚‚å¿…ãšã‚³ãƒŸãƒƒãƒˆã«å«ã‚ã‚‹"

hats:
  builder:
    name: "ğŸ”¨ Builder"
    description: "CHECKLIST.mdã®æ¬¡ã®[ ]ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè£…ã—[x]ã«æ›´æ–°"
    triggers: ["build.task"]
    publishes: ["build.done", "build.blocked"]
    default_publishes: "build.done"
    instructions: |
      ## BUILDER PHASE

      CHECKLIST.md ã®ã‚¿ã‚¹ã‚¯ã‚’1ã¤ãšã¤å®Ÿè£…ã™ã‚‹ã€‚

      ### âš ï¸ æ¯å›å¿…ãšå®Ÿè¡Œã™ã‚‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

      **Step 1: CHECKLIST.md ã‚’èª­ã‚“ã§æ¬¡ã® [ ] ã‚’è¦‹ã¤ã‘ã‚‹**
      ```bash
      cat docs/CHECKLIST.md
      ```
      â†’ æœ€åˆã«è¦‹ã¤ã‹ã£ãŸ `- [ ]` ãŒã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
      â†’ Phaseé †ã«é€²ã‚ã‚‹ (Phase 0 â†’ 1 â†’ 2 â†’ ...)
      â†’ ã‚¿ã‚¹ã‚¯ã«å‚ç…§ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹å ´åˆã¯è©²å½“docsã‚‚èª­ã‚€ (MIGRATION/PROJECT_STRUCTURE/IMPLEMENTATION ãªã©)

      **Step 2: ARCHITECTURE.md ã‚’èª­ã‚“ã§ç¦æ­¢äº‹é …ã‚’ç¢ºèª**
      ```bash
      cat docs/ARCHITECTURE.md
      ```
      ç¢ºèªãƒã‚¤ãƒ³ãƒˆ:
      - ç¦æ­¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒª (FreeType, OpenGL, SDL, stb_image, AppKit)
      - 5ã¤ã®æŸ± (SwiftUI, Metal, C++, oF APIäº’æ›, Apple Native)
      - å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ (pImpl, @autoreleasepool)
      - åº§æ¨™ç³» (2D: å·¦ä¸ŠåŸç‚¹, 3D: å³æ‰‹ç³», Texture: å·¦ä¸ŠåŸç‚¹)
      - Metal NDCå¤‰æ›/Yåè»¢ã¯rendererå´ã§å¸å

      **Step 3: å®Ÿè£…**
      ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã«å¾“ã† (ARCHITECTURE.mdå„ªå…ˆã€‚CHECKLISTã®ãƒ‘ã‚¹æŒ‡å®šãŒã‚ã‚‹å ´åˆã¯ãã‚Œã«å¾“ã†):
      ```
      src/
      â”œâ”€â”€ core/           # AppBase, Context
      â”œâ”€â”€ math/           # Types.h (simd), ofVec*, ofMatrix*
      â”œâ”€â”€ addons/
      â”‚   â”œâ”€â”€ core/       # Core Addons
      â”‚   â””â”€â”€ native/     # Apple Native Addons (CHECKLISTãŒapple_nativeè¡¨è¨˜ãªã‚‰ãã¡ã‚‰)
      â”œâ”€â”€ platform/
      â”‚   â”œâ”€â”€ swiftui/    # App.swift, MetalView.swift
      â”‚   â””â”€â”€ bridge/     # SwiftBridge.h/.mm
      â”œâ”€â”€ render/
      â”‚   â”œâ”€â”€ DrawList, DrawCommand, RenderTypes
      â”‚   â””â”€â”€ metal/      # MetalRenderer, MetalTexture
      â””â”€â”€ oflike/
          â”œâ”€â”€ app/        # ofBaseApp, ofAppRunner
          â”œâ”€â”€ graphics/   # ofGraphics, ofPath, ofTrueTypeFont
          â”œâ”€â”€ 3d/         # ofMesh, ofCamera, of3dPrimitive
          â”œâ”€â”€ image/      # ofTexture, ofPixels, ofImage
          â”œâ”€â”€ lighting/   # ofLight, ofMaterial
          â”œâ”€â”€ types/      # ofColor, ofRectangle
          â””â”€â”€ utils/      # ofUtils, ofLog
      ```

      **Step 4: ãƒ“ãƒ«ãƒ‰ç¢ºèª**
      ```bash
      # Xcode ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å ´åˆ
      xcodebuild -scheme oflike-metal build 2>&1 | head -50
      # ã¾ãŸã¯ CMake
      cd build && cmake .. && make -j8 2>&1 | head -100
      ```

      **Step 5: CHECKLIST.md ã‚’æ›´æ–° (å¿…é ˆ)**
      å®Œäº†ã—ãŸã‚¿ã‚¹ã‚¯ã‚’ `- [ ]` â†’ `- [x]` ã«å¤‰æ›´

      **Step 6: CHECKLISTæ›´æ–°ã‚’æ¤œè¨¼ (å¿…é ˆ)**
      ```bash
      # æ›´æ–°å‰ã®çŠ¶æ…‹ã‚’ç¢ºèª
      grep -n "\- \[ \]" docs/CHECKLIST.md | head -5

      # ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¦ [ ] â†’ [x] ã«å¤‰æ›´
      # (å®Ÿè£…ã—ãŸã‚¿ã‚¹ã‚¯ã®è¡Œã‚’ç·¨é›†)

      # æ›´æ–°å¾Œ: è©²å½“è¡ŒãŒ [x] ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
      grep -n "\- \[x\].*<å®Ÿè£…ã—ãŸã‚¿ã‚¹ã‚¯åã®ä¸€éƒ¨>" docs/CHECKLIST.md
      ```
      â†’ **[x] ãŒç¢ºèªã§ãã‚‹ã¾ã§ build.done ã‚’ç™ºè¡Œã—ãªã„**

      ### Before Starting
      1. `ralph tools task list` ã§ open tasks ç¢ºèª
      2. ãªã‘ã‚Œã° CHECKLIST.md ã‹ã‚‰æ¬¡ã® [ ] ã‚’é¸æŠ
      3. `ralph tools task add "Phase X.Y: <ã‚¿ã‚¹ã‚¯å>" -p 1`

      ### å®Œäº†æ™‚ (ã“ã®é †åºã‚’å³å®ˆ)
      1. docs/CHECKLIST.md ã®è©²å½“é …ç›®ã‚’ `[x]` ã«æ›´æ–°
      2. **grep ã§ [x] æ›´æ–°ã‚’æ¤œè¨¼** â† å¿…é ˆ
      3. `ralph tools task close <id>`
      4. `ralph emit "build.done" "completed: <ã‚¿ã‚¹ã‚¯å>, checklist: updated"`

      ### âš ï¸ CHECKLISTæœªæ›´æ–°ã§ build.done ã‚’ç™ºè¡Œã—ã¦ã¯ã„ã‘ãªã„
      CHECKLIST.md ã« [x] ãŒå…¥ã£ã¦ã„ãªã„å ´åˆã¯ã€å…ˆã«æ›´æ–°ã™ã‚‹ã“ã¨ã€‚

      ### ãƒ–ãƒ­ãƒƒã‚¯æ™‚
      ```bash
      ralph emit "build.blocked" "tried: <what>, blocked: <why>"
      ```

  confessor:
    name: "ğŸ” Confessor"
    description: "ARCHITECTURE.mdæº–æ‹ ã¨å®Ÿè£…å“è³ªã‚’ç›£æŸ»"
    triggers: ["build.done"]
    publishes: ["confession.clean", "confession.issues_found"]
    default_publishes: "confession.clean"
    instructions: |
      ## CONFESSION PHASE

      å®Ÿè£…ãŒARCHITECTURE.mdã«æº–æ‹ ã—ã¦ã„ã‚‹ã‹ç›£æŸ»ã™ã‚‹ã€‚

      ### âš ï¸ æ¯å›å¿…ãšå®Ÿè¡Œã™ã‚‹ãƒã‚§ãƒƒã‚¯

      **Step 1: ARCHITECTURE.md ã‚’èª­ã‚€**
      ```bash
      cat docs/ARCHITECTURE.md
      ```

      **Step 2: ç¦æ­¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªæ¤œå‡º**
      ```bash
      # FreeType
      grep -r "FT_\|freetype\|FreeType" src/ --include="*.h" --include="*.cpp" --include="*.mm"
      # OpenGL
      grep -r "glBegin\|glEnd\|GL_\|glGen\|glBind\|#include.*gl\.h" src/
      # SDL/GLFW
      grep -r "SDL_\|GLFW\|glfwInit" src/
      # stb_image
      grep -r "stb_image\|STB_IMAGE\|stbi_" src/
      # AppKitç›´æ¥ä½¿ç”¨ (SwiftUI/MTKViewã®ä½ãƒ¬ãƒ™ãƒ«ãƒ–ãƒªãƒƒã‚¸ã®ã¿è¨±å¯)
      grep -r "NSWindow\|NSView\|NSEvent\|NSResponder" src/ --include="*.swift"
      # GLM (æ–°è¦ã‚³ãƒ¼ãƒ‰ã§ã¯éæ¨å¥¨)
      grep -r "glm::" src/ --include="*.h" --include="*.cpp"
      ```
      â†’ ãƒ’ãƒƒãƒˆã—ãŸã‚‰ç”¨é€”ã‚’ç¢ºèª (SwiftUI/MTKViewã®ä½ãƒ¬ãƒ™ãƒ«ãƒ–ãƒªãƒƒã‚¸ä»¥å¤–ã¯NG)ã€‚å•é¡ŒãŒã‚ã‚Œã° `confession.issues_found`

      **Step 3: å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ç¢ºèª**
      - ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ˜ãƒƒãƒ€ãƒ¼ (.h) ã« Objective-C å‹ãŒãªã„ã‹
      - pImpl ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒä½¿ã‚ã‚Œã¦ã„ã‚‹ã‹
      - @autoreleasepool ãŒé©åˆ‡ã«ä½¿ã‚ã‚Œã¦ã„ã‚‹ã‹

      **Step 4: oF APIäº’æ›æ€§ç¢ºèª**
      - é–¢æ•°ã‚·ã‚°ãƒãƒãƒ£ãŒoFã¨ä¸€è‡´ã—ã¦ã„ã‚‹ã‹
      - åº§æ¨™ç³»ãŒæ­£ã—ã„ã‹ (2D: å·¦ä¸ŠåŸç‚¹, 3D: å³æ‰‹ç³», Texture: å·¦ä¸ŠåŸç‚¹)
      - Metal NDCå¤‰æ›/Yåè»¢ãŒrendererå´ã«ã‚ã‚‹ã‹

      **Step 5: CHECKLIST.md æ›´æ–°ç¢ºèª (æœ€é‡è¦)**

      ```bash
      # æœ€è¿‘ã®git diffã§CHECKLIST.mdã®å¤‰æ›´ã‚’ç¢ºèª
      git diff docs/CHECKLIST.md

      # ã¾ãŸã¯æœªã‚³ãƒŸãƒƒãƒˆã®å¤‰æ›´ã‚’ç¢ºèª
      git diff --cached docs/CHECKLIST.md

      # [x] ã®æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆï¼ˆå¢—ãˆã¦ã„ã‚‹ã¯ãšï¼‰
      grep -c "\- \[x\]" docs/CHECKLIST.md
      ```

      **å¿…é ˆãƒã‚§ãƒƒã‚¯:**
      - [ ] CHECKLIST.md ã«å¤‰æ›´ãŒã‚ã‚‹ã‹
      - [ ] å®Ÿè£…ã—ãŸã‚¿ã‚¹ã‚¯ãŒ `- [x]` ã«ãªã£ã¦ã„ã‚‹ã‹
      - [ ] `- [ ]` â†’ `- [x]` ã®å·®åˆ†ãŒè¦‹ãˆã‚‹ã‹

      â†’ **[x] æ›´æ–°ãŒç¢ºèªã§ããªã„å ´åˆã¯å³ `confession.issues_found`**

      ### ConfessionReport
      ```bash
      ralph tools memory add "confession: arch-violation=<None|è©³ç´°>" -t context --tags confession
      ralph tools memory add "confession: checklist-updated=<Yes|No|æ¤œè¨¼æ–¹æ³•>" -t context --tags confession
      ralph tools memory add "confession: oF-compat=<Yes|No|å·®ç•°è©³ç´°>" -t context --tags confession
      ```

      ### Publish (å³æ ¼ãªåˆ¤å®š)

      **å³ `confession.issues_found` ã‚’ç™ºè¡Œ:**
      - ARCHITECTUREé•åãŒã‚ã‚‹
      - **CHECKLIST.md ãŒæ›´æ–°ã•ã‚Œã¦ã„ãªã„** â† æœ€é‡è¦
      - **git diff ã§ [x] å¤‰æ›´ãŒç¢ºèªã§ããªã„**

      **`confession.clean` ã‚’ç™ºè¡Œã§ãã‚‹æ¡ä»¶:**
      - ARCHITECTUREé•åãªã— AND
      - **CHECKLIST.md ã« [x] æ›´æ–°ãŒç¢ºèªã§ããŸ** AND
      - oF APIäº’æ›æ€§ã«å•é¡Œãªã—

      âš ï¸ CHECKLISTæœªæ›´æ–°ã¯é‡å¤§ãªå•é¡Œã¨ã—ã¦æ‰±ã†

  committer:
    name: "ğŸ“¦ Committer"
    description: "å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆã—ã¦GitHubã«pushã€‚é–‹ç™ºé€²æ—ã‚’ãƒªãƒ¢ãƒ¼ãƒˆã§ç¢ºèªå¯èƒ½ã«ã€‚"
    triggers: ["confession.clean"]
    publishes: ["commit.done", "commit.failed"]
    default_publishes: "commit.done"
    instructions: |
      ## COMMITTER PHASE

      å®Ÿè£…ãŒæ‰¿èªã•ã‚ŒãŸã®ã§ã€å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆã—ã¦GitHubã«pushã™ã‚‹ã€‚

      ### âš ï¸ æ¯å›å¿…ãšå®Ÿè¡Œã™ã‚‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

      **Step 1: å¤‰æ›´å†…å®¹ã‚’ç¢ºèª**
      ```bash
      git status
      git diff --stat
      ```

      **Step 2: å¤‰æ›´ã‚’ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°**
      ```bash
      # å…¨ã¦ã®å¤‰æ›´ã‚’ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°
      git add -A

      # ã¾ãŸã¯ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿
      git add src/ docs/CHECKLIST.md
      ```

      **Step 3: ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä½œæˆ**
      Conventional Commits å½¢å¼:
      ```
      <type>(<scope>): <description>

      <body>

      ğŸ¤– Auto-committed by ralph-orchestrator
      ```

      **Types:**
      - `feat`: æ–°æ©Ÿèƒ½ (Phase X.Y ã®æ–°è¦å®Ÿè£…)
      - `fix`: ãƒã‚°ä¿®æ­£
      - `refactor`: ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
      - `docs`: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°
      - `chore`: ãã®ä»–

      **Scope:** Phaseç•ªå· or ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå
      - `phase-0`, `phase-1`, `swiftui`, `metal`, `oflike`, etc.

      **ä¾‹:**
      ```bash
      git commit -m "feat(phase-1): implement MTKView integration

      - Add MetalView.swift with NSViewRepresentable
      - Implement MTKViewDelegate for frame loop
      - Update CHECKLIST.md progress

      ğŸ¤– Auto-committed by ralph-orchestrator"
      ```

      **Step 4: GitHubã«push**
      ```bash
      git push origin main
      ```
      â†’ pushå¤±æ•—æ™‚ã¯ã‚¨ãƒ©ãƒ¼å†…å®¹ã‚’ç¢ºèª

      **Step 5: pushæˆåŠŸã‚’ç¢ºèª**
      ```bash
      git log --oneline -1
      git remote -v
      ```

      ### ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³
      - CHECKLIST.md ã®ã‚¿ã‚¹ã‚¯åã‚’å«ã‚ã‚‹
      - å®Ÿè£…ã—ãŸå†…å®¹ã‚’ç®‡æ¡æ›¸ãã§è¨˜è¼‰
      - Phaseç•ªå·ã‚’æ˜è¨˜

      ### å®Œäº†æ™‚
      ```bash
      ralph emit "commit.done" "pushed: <commit message summary>"
      ```

      ### å¤±æ•—æ™‚
      ```bash
      ralph emit "commit.failed" "error: <what went wrong>"
      ```
      â†’ Handler ãŒä¿®æ­£ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆ

  handler:
    name: "âš–ï¸ Handler"
    description: "æ¬¡ã®ã‚¿ã‚¹ã‚¯ã‚’æ±ºå®šã€‚CHECKLIST.mdã‚’å‚ç…§ã€‚"
    triggers: ["confession.issues_found", "commit.done", "commit.failed"]
    publishes: ["build.task", "escalate.human"]
    default_publishes: "build.task"
    instructions: |
      ## HANDLER PHASE

      ### âš ï¸ æœ€åˆã« CHECKLIST.md ã‚’èª­ã‚€
      ```bash
      cat docs/CHECKLIST.md
      ```

      ### confession.issues_found ã®å ´åˆ
      1. å•é¡Œã‚’æ¤œè¨¼
      2. å•é¡ŒãŒå®Ÿåœ¨:
         - ARCHITECTUREé•å: ä¿®æ­£ã‚¿ã‚¹ã‚¯ä½œæˆ
         - CHECKLISTæœªæ›´æ–°: æ›´æ–°ã‚¿ã‚¹ã‚¯ä½œæˆ
         ```bash
         ralph tools task add "Fix: <issue>" -p 1
         ralph emit "build.task" "fix needed: <summary>"
         ```
      3. é‡å¤§ãªè¨­è¨ˆé•å: `escalate.human`

      ### commit.failed ã®å ´åˆ
      1. ã‚¨ãƒ©ãƒ¼å†…å®¹ã‚’ç¢ºèª
      2. ä¿®æ­£ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆ:
         ```bash
         ralph tools task add "Fix git: <issue>" -p 1
         ralph emit "build.task" "git fix needed: <summary>"
         ```
      3. ãƒªãƒ¢ãƒ¼ãƒˆè¨­å®šå•é¡Œãªã©é‡å¤§ãªå ´åˆ: `escalate.human`

      ### commit.done ã®å ´åˆ (æˆåŠŸãƒ‘ã‚¹)

      **ã¾ãš CHECKLIST.md ã®é€²æ—ã‚’æ¤œè¨¼:**
      ```bash
      # [x] ã®ç·æ•°ã‚’ç¢ºèªï¼ˆå‰å›ã‚ˆã‚Šå¢—ãˆã¦ã„ã‚‹ã¯ãšï¼‰
      echo "Completed tasks: $(grep -c '\- \[x\]' docs/CHECKLIST.md)"

      # æœ€æ–°ã®ã‚³ãƒŸãƒƒãƒˆã§ CHECKLIST.md ãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹ã‹
      git show --stat HEAD | grep CHECKLIST
      ```
      â†’ CHECKLIST.md ã®æ›´æ–°ãŒãªã„å ´åˆã¯è­¦å‘Šã‚’è¨˜éŒ²

      **CHECKLIST.md ã‹ã‚‰æ¬¡ã® [ ] ã‚’è¦‹ã¤ã‘ã‚‹:**

      Phaseé †ã«é€²ã‚ã‚‹:
      - Phase 0: Structure & Policy (Must Decide First)
      - Phase 1: Build Stabilization (Before Deeper Refactors)
      - Phase 2: App Entry & Lifecycle
      - Phase 3: Renderer Ownership & Bridge
      - Phase 4: MetalRenderer Execution (Drawing Must Work)
      - Phase 5: SwiftUI Integration (DrawList Path)
      - Phase 6: oflike Graphics 2D + Matrix
      - Phase 7: Device/Resource Ownership + Texture/FBO
      - Phase 8: 3D / Camera / Mesh / Lighting
      - Phase 9: Utilities / Image I/O
      - Phase 10: Project Generator (CLI First)
      - Phase 11: Validation
      - Phase 12: Addons (Last)

      ### æ¬¡ã®ã‚¿ã‚¹ã‚¯ä½œæˆ
      ```bash
      # CHECKLIST.md ã‹ã‚‰æœ€åˆã® [ ] ã‚’è¦‹ã¤ã‘ã¦ã‚¿ã‚¹ã‚¯ä½œæˆ
      ralph tools task add "Phase X.Y: <ã‚¿ã‚¹ã‚¯å>" -p 1
      ralph emit "build.task" "next: <ã‚¿ã‚¹ã‚¯å>"
      ```

      ### é€²æ—è¨˜éŒ²
      ```bash
      ralph tools memory add "completed: Phase X.Y, next: Phase X.Z" -t pattern --tags progress
      ```

      ### LOOP_COMPLETE æ¡ä»¶
      - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ "stop" ã¨è¨€ã£ãŸå ´åˆ
      - å…¨PhaseãŒå®Œäº†ã—ãŸå ´åˆ (CHECKLIST.mdã« [ ] ãŒãªã„)

# Task tracking
tasks:
  enabled: true

# Memory - ã‚»ãƒƒã‚·ãƒ§ãƒ³é–“ã§å­¦ç¿’ã‚’ä¿æŒ
memories:
  enabled: true
  inject: auto
  budget: 3000
  filter:
    types: []
    tags: []
    recent: 0
